<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Or how to find copied and pasted code">
<meta name="keywords" content=" ">
<title>Finding duplicated code | PMD Source Code Analyzer</title>
<link rel="stylesheet" href="css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" href="css/lavish-bootstrap.css">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
<link rel="icon" href="images/favicon.ico" type="image/x-icon">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://pmd.sourceforge.net/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> PMD Source Code Analyzer Project</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->
                
                
                
                <li><a href="https://github.com/pmd/pmd/releases/latest" target="_blank">Download</a></li>
                
                
                
                <li><a href="https://github.com/pmd/pmd" target="_blank">Fork us on github</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Finding duplicated code">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                








<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">PMD 6.0.0</li>
    
    
    
        
    
    <li>
        
        <a href="#">User Documentation</a>
        
        <ul>
            
            

            

                
                <li><a href="index.html">Introduction</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_release_notes.html">Release Notes</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_getting_started.html">Getting Started</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_understanding_rulesets.html">Understanding Rulesets</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_best_practices.html">Best Pratices</a></li>
                

            

            
            
            

            

                
                <li class="active"><a href="pmd_userdocs_cpd.html">Copy-Paste Detection</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_suppressing.html">Suppressing</a></li>
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Tools / Integrations</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_userdocs_tools_maven.html">Maven PMD Plugin</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_userdocs_tools_ant.html">Ant</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_userdocs_tools.html">Other Tools / Integrations</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_faq.html">FAQ</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_help.html">Getting Help</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_news.html">PMD in the press</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_products.html">Products/books related to PMD</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_similarprojects.html">Similar Projects</a></li>
                

            

            
            
            

            

                
                <li><a href="license.html">License</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_credits.html">Credits</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_meaning.html">What does 'PMD' mean?</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_release_notes_old.html">Old Release Notes</a></li>
                

            

            
            
        </ul>
     </li>
       
        
    
    <li>
        
        <a href="#">Rule Reference</a>
        
        <ul>
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Apex Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_apex.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_apex_bestpractices.html">Best Practices</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_apex_codestyle.html">Code Style</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_apex_design.html">Design</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_apex_errorprone.html">Error Prone</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_apex_performance.html">Performance</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_apex_security.html">Security</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Ecmascript Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_ecmascript.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_ecmascript_bestpractices.html">Best Practices</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_ecmascript_codestyle.html">Code Style</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_ecmascript_errorprone.html">Error Prone</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Java Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_java.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_java_bestpractices.html">Best Practices</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_java_codestyle.html">Code Style</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_java_design.html">Design</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_java_documentation.html">Documentation</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_java_errorprone.html">Error Prone</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_java_multithreading.html">Multithreading</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_java_performance.html">Performance</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Java Server Pages Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_jsp.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_jsp_bestpractices.html">Best Practices</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_jsp_codestyle.html">Code Style</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_jsp_design.html">Design</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_jsp_errorprone.html">Error Prone</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_jsp_security.html">Security</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Maven POM Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_pom.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_pom_errorprone.html">Error Prone</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">PLSQL Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_plsql.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_plsql_bestpractices.html">Best Practices</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_plsql_codestyle.html">Code Style</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_plsql_design.html">Design</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_plsql_errorprone.html">Error Prone</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Salesforce VisualForce Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_vf.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_vf_security.html">Security</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">VM Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_vm.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_vm_bestpractices.html">Best Practices</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_vm_design.html">Design</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_vm_errorprone.html">Error Prone</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">XML Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_xml.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_xml_errorprone.html">Error Prone</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">XSL Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_xsl.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_xsl_codestyle.html">Code Style</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_xsl_performance.html">Performance</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
        </ul>
     </li>
       
        
    
    <li>
        
        <a href="#">Language Specific Documentation</a>
        
        <ul>
            
            

            

                
                <li><a href="pmd_languages_jsp.html">JSP Support</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_java_metrics_index.html">Java code metrics</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_apex_metrics_index.html">Apex code metrics</a></li>
                

            

            
            
        </ul>
     </li>
       
        
    
    <li>
        
        <a href="#">Developer Documentation</a>
        
        <ul>
            
            

            

                
                <li><a href="pmd_devdocs_development.html">Developer Resources</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_writing_documentation.html">Writing Documentation</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_codestyle.html">Code Style</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_setting_up_ide.html">Setting up your IDE</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_pull_requests.html">Pull Requests</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_building.html">Building PMD from source</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_testing.html">Testing / Test Framework</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_releasing.html">Releasing</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_architecture.html">Architecture</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_roadmap.html">Roadmap</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_how_pmd_works.html">How PMD Works</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_writing_pmd_rules.html">Writing a Rule</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_writing_xpath_rules.html">Writing XPath Rules</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_metrics_howto.html">Using code metrics in custom rules</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_making_rulesets.html">Making Rulesets</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_rule_guidelines.html">Rule Guidelines</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_working_with_properties.html">Working with properties</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_adding_new_language.html">Adding a New Language</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_adding_new_cpd_language.html">Adding a New CPD Language</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_adding_metrics_support_to_language.html">Adding metrics support to a language</a></li>
                

            

            
            
        </ul>
     </li>
       
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">Finding duplicated code</h1>
</div>



<div class="post-content">

   
    <div class="summary">Or how to find copied and pasted code</div>
   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    


    

        
        

    <a target="_blank" href="https://github.com/pmd/pmd/blob/master/docs/pages/pmd/userdocs/cpd.md" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit me</a>

    

  <h2 id="overview">Overview</h2>

<p>Duplicate code can be hard to find, especially in a large project.
But PMD’s Copy/Paste Detector (CPD) can find it for you!
CPD has been through three major incarnations:</p>

<ul>
  <li>
    <p>First we wrote it using a variant of Michael Wise’s Greedy String Tiling algorithm (our variant is described
<a href="http://www.onjava.com/pub/a/onjava/2003/03/12/pmd_cpd.html">here</a>).</p>
  </li>
  <li>
    <p>Then it was completely rewritten by Brian Ewins using the
<a href="http://dogma.net/markn/articles/bwt/bwt.htm">Burrows-Wheeler transform</a>.</p>
  </li>
  <li>
    <p>Finally, it was rewritten by Steve Hawkins to use the
<a href="http://www.nist.gov/dads/HTML/karpRabin.html">Karp-Rabin</a> string matching algorithm.</p>
  </li>
</ul>

<p>Each rewrite made it much faster, and now it can process the JDK 1.4 java.* packages in about 4 seconds
(on my workstation, at least).</p>

<p>Note that CPD works with Java, JSP, C, C++, C#, Fortran and PHP code and some more languages. For the
full list, see below <a href="#supported-languages">Supported Languages</a>.</p>

<p>Your own language is missing?
See how to add it <a href="/pmd_devdocs_adding_new_cpd_language.html">here</a>.</p>

<p>CPD is included with PMD, which you can download <a href="http://sourceforge.net/projects/pmd/files/pmd/">here</a>.</p>

<h2 id="command-line-usage">Command line usage</h2>

<h3 id="windows">Windows</h3>

<p>CPD comes with its own starter batch file: <code class="highlighter-rouge">cpd.bat</code>. It’s located in the <code class="highlighter-rouge">bin</code> subdirectory in the PMD
binary distribution zip-file. Let’s assume, you are in this directory, then you can start CPD this way:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>cpd.bat --minimum-tokens 100 --files c:\temp\src\java
</code></pre>
</div>

<p>The options “minimum-tokens” and “files” are the two required options; there are more options, see below.</p>

<h3 id="linux">Linux</h3>

<p>For Linux, there is since PMD 5.0 a combined start script for all command line tools. This includes CPD.
The start script is called <code class="highlighter-rouge">run.sh</code> and is located in the <code class="highlighter-rouge">bin</code> subdirectory in the PMD binary distribution
zip-file. Let’s assume, you are in this directory, then you can start CPD this way:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>./run.sh cpd --minimum-tokens 100 --files /tmp/src/java
</code></pre>
</div>

<p>The options “minimum-tokens” and “files” are the two required options; there are more options, see below.</p>

<h3 id="options">Options</h3>

<table>
    <tr>
        <th>Option</th>
        <th>Description</th>
        <th>Required</th>
        <th>Applies for language</th>
    </tr>
    <tr>
        <td>--minimum-tokens</td>
        <td>The minimum token length which should be reported as a duplicate.</td>
        <td>yes</td>
        <td></td>
    </tr>
    <tr>
        <td>--files</td>
        <td>List of files and directories to process</td>
        <td>yes</td>
        <td></td>
    </tr>
    <tr>
        <td>--filelist</td>
        <td>Path to file containing a comma delimited list of files to analyze. If this is given, then you don't need to provide `--files`.</td>
        <td>no</td>
        <td></td>
    </tr>
    <tr>
        <td>--language</td>
        <td>Sources code language. Default value is `java`</td>
        <td>no</td>
        <td></td>
    </tr>
    <tr>
        <td>--encoding</td>
        <td>Character encoding to use when processing files</td>
        <td>no</td>
        <td></td>
    </tr>
    <tr>
        <td>--skip-duplicate-files</td>
        <td>Ignore multiple copies of files of the same name and length in comparison.</td>
        <td>no</td>
        <td></td>
    </tr>
    <tr>
        <td>--exclude</td>
        <td>Files to be excluded from CPD check</td>
        <td>no</td>
        <td></td>
    </tr>
    <tr>
        <td>--non-recursive</td>
        <td>Don't scan subdirectiories</td>
        <td>no</td>
        <td></td>
    </tr>
    <tr>
        <td>--skip-lexical-errors</td>
        <td>Skip files which can't be tokenized due to invalid characters instead of aborting CPD</td>
        <td>no</td>
        <td></td>
    </tr>
    <tr>
        <td>--format</td>
        <td>Report format. Default value is `text`.</td>
        <td>no</td>
        <td></td>
    </tr>
    <tr>
        <td>--failOnViolation {true|false}</td>
        <td>By default CPD exits with status 4 if code duplications are found.
            Disable this option with '--failOnViolation false' to exit with 0 instead and just write the report.</td>
        <td>no</td>
        <td></td>
    </tr>
    <tr>
        <td>--ignore-literals</td>
        <td>Ignore number values and string contents when comparing text</td>
        <td>no</td>
        <td>java</td>
    </tr>
    <tr>
        <td>--ignore-identifiers</td>
        <td>Ignore constant and variable names when comparing text</td>
        <td>no</td>
        <td>java</td>
    </tr>
    <tr>
        <td>--ignore-annotations</td>
        <td>Ignore language annotations when comparing text</td>
        <td>no</td>
        <td>java</td>
    </tr>
    <tr>
        <td>--ignore-usings</td>
        <td>Ignore using directives in C# when comparing text</td>
        <td>no</td>
        <td>C#</td>
    </tr>
    <tr>
        <td>--no-skip-blocks</td>
        <td>Do not skip code blocks marked with --skip-blocks-pattern (e.g. #if 0 until #endif)</td>
        <td>no</td>
        <td>cpp</td>
    </tr>
    <tr>
        <td>--skip-blocks-pattern</td>
        <td>
            Pattern to find the blocks to skip. Start and End pattern separated by |.
            Default is `#if 0|#endif`.
        </td>
        <td>no</td>
        <td>cpp</td>
    </tr>
    <tr>
        <td>--uri</td>
        <td>URI to process</td>
        <td>no</td>
        <td>plsql</td>
    </tr>
    <tr>
        <td>--help / -h</td>
        <td>Print help text</td>
        <td>no</td>
        <td></td>
    </tr>
</table>

<h3 id="examples">Examples</h3>

<p><em>Note:</em> The following example use the Linux start script. For Windows, just replace “./run.sh cpd” by “cpd.bat”.</p>

<p>Minimum required options: Just give it the minimum duplicate size and the source directory:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ ./run.sh cpd --minimum-tokens 100 --files /usr/local/java/src/java
</code></pre>
</div>

<p>You can also specify the language:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ ./run.sh cpd --minimum-tokens 100 --files /path/to/c/source --language cpp
</code></pre>
</div>

<p>You may wish to check sources that are stored in different directories:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ ./run.sh cpd --minimum-tokens 100 --files /path/to/other/source  --files /path/to/other/source --files /path/to/other/source --language fortran
</code></pre>
</div>

<p><em>There should be no limit to the number of ‘–files’, you may add… But if you stumble one, please tell us !</em></p>

<p>And if you’re checking a C source tree with duplicate files in different architecture directories
you can skip those using –skip-duplicate-files:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ ./run.sh cpd --minimum-tokens 100 --files /path/to/c/source --language cpp --skip-duplicate-files
</code></pre>
</div>

<p>You can also specify the encoding to use when parsing files:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ ./run.sh cpd --minimum-tokens 100 --files /usr/local/java/src/java --encoding utf-16le
</code></pre>
</div>

<p>You can also specify a report format - here we’re using the XML report:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ ./run.sh cpd --minimum-tokens 100 --files /usr/local/java/src/java --format xml
</code></pre>
</div>

<p>The default format is a text report, and there’s also a <code class="highlighter-rouge">csv</code> report.</p>

<p>Note that CPD is pretty memory-hungry; you may need to give Java more memory to run it, like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ export HEAPSIZE=512m
$ ./run.sh cpd --minimum-tokens 100 --files /usr/local/java/src/java
</code></pre>
</div>

<p>In order to change the heap size under Windows, you’ll need to edit the batch file <code class="highlighter-rouge">cpd.bat</code> set the “OPTS”
variable to <code class="highlighter-rouge">-Xmx512m</code>.</p>

<p>If you specify a source directory but don’t want to scan the sub-directories, you can use the non-recursive option:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ ./run.sh cpd --minimum-tokens 100 --non-recursive --files /usr/local/java/src/java
</code></pre>
</div>

<h3 id="exit-status">Exit status</h3>

<p>Please note that if CPD detects duplicated source code, it will exit with status 4 (since 5.0).
This behavior has been introduced to ease CPD integration into scripts or hooks, such as SVN hooks.</p>

<table>
<tr><td>0</td><td>Everything is fine, now code duplications found</td></tr>
<tr><td>1</td><td>Couldn't understand command line parameters or CPD exited with an exception</td></tr>
<tr><td>4</td><td>At least one code duplication has been detected unless '--failOnViolation false' is used.</td></tr>
</table>

<h3 id="supported-languages">Supported Languages</h3>

<ul>
  <li>Apex</li>
  <li>C#</li>
  <li>C/C++</li>
  <li>EcmaScript (JavaScript)</li>
  <li>Fortran</li>
  <li>Go</li>
  <li>Groovy</li>
  <li>Java</li>
  <li>Jsp</li>
  <li>Matlab</li>
  <li>Objective-C</li>
  <li>Perl</li>
  <li>PHP</li>
  <li>PL/SQL</li>
  <li>Python</li>
  <li>Ruby</li>
  <li>Scala</li>
  <li>Swift</li>
  <li>Visualforce</li>
</ul>

<h3 id="available-formats">Available formats</h3>

<ul>
  <li>text : Default format</li>
  <li>xml</li>
  <li>csv</li>
  <li>csv_with_linecount_per_file</li>
  <li>vs</li>
</ul>

<h2 id="ant-task">Ant task</h2>

<p>Andy Glover wrote an Ant task for CPD; here’s how to use it:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;target name="cpd"&gt;
    &lt;taskdef name="cpd" classname="net.sourceforge.pmd.cpd.CPDTask" /&gt;
    &lt;cpd minimumTokenCount="100" outputFile="/home/tom/cpd.txt"&gt;
        &lt;fileset dir="/home/tom/tmp/ant"&gt;
            &lt;include name="**/*.java"/&gt;
        &lt;/fileset&gt;
    &lt;/cpd&gt;
&lt;/target&gt;
</code></pre>
</div>

<table border="1" cellpadding="2" cellspacing="0">
  <tr>
    <td valign="top"><b>Attribute</b></td>
    <td valign="top"><b>Description</b></td>
    <td valign="top"><b>Applies for language</b></td>
    <td align="center" valign="top"><b>Required</b></td>
  </tr>
  <tr>
    <td valign="top">encoding</td>
    <td valign="top">
        The character set encoding (e.g., UTF-8) to use when reading the source code files, but also when
        producing the report. A piece of warning, even if you set properly the encoding value,
        let's say to UTF-8, but you are running CPD encoded with CP1252, you may end up with not UTF-8 file.
        Indeed, CPD copy piece of source code in its report directly, therefore, the source files
        keep their encoding.<br />
        If not specified, CPD uses the system default encoding.
    </td>
    <td valign="top"></td>
    <td valign="top" align="center">No</td>
  </tr>
  <tr>
    <td valign="top">format</td>
    <td valign="top">The format of the report (e.g. `csv`, `text`, `xml`); defaults to `text`.</td>
    <td valign="top"></td>
    <td valign="top" align="center">No</td>
  </tr>
  <tr>
    <td valign="top">ignoreLiterals</td>
    <td valign="top">
        if `true`, CPD ignores literal
        value differences when evaluating a duplicate block. This means that `foo=42;` and `foo=43;`
        will be seen as equivalent. You may want to run PMD with this option off to start with and
        then switch it on to see what it turns up; defaults to `false`.
    </td>
    <td valign="top">java</td>
    <td valign="top" align="center">No</td>
  </tr>
  <tr>
    <td valign="top">ignoreIdentifiers</td>
    <td valign="top">
        Similar to `ignoreLiterals` but for identifiers; i.e., variable names, methods names,
        and so forth; defaults to `false`.
    </td>
    <td valign="top">java</td>
    <td valign="top" align="center">No</td>
  </tr>
  <tr>
    <td valign="top">ignoreAnnotations</td>
    <td valign="top">
        Ignore annotations. More and more modern frameworks use annotations on classes and methods,
        which can be very redundant and trigger CPD matches. With J2EE (CDI, Transaction Handling, etc)
        and Spring (everything) annotations become very redundant. Often classes or methods have the
        same 5-6 lines of annotations. This causes false positives; defaults to `false`.
    </td>
    <td valign="top">java</td>
    <td valign="top" align="center">No</td>
  </tr>
  <tr>
    <td valign="top">ignoreUsings</td>
    <td valign="top">
        Ignore using directives in C#.
    </td>
    <td valign="top">C#</td>
    <td valign="top" align="center">No</td>
  </tr>
  <tr>
    <td valign="top">skipDuplicateFiles</td>
    <td valign="top">
        Ignore multiple copies of files of the same name and length in comparison; defaults to `false`.
    </td>
    <td valign="top"></td>
    <td valign="top" align="center">No</td>
  </tr>
  <tr>
    <td valign="top">skipLexicalErrors</td>
    <td valign="top">
        Skip files which can't be tokenized due to invalid characters instead of aborting CPD; defaults to `false`.
    </td>
    <td valign="top"></td>
    <td valign="top" align="center">No</td>
  </tr>
  <tr>
    <td valign="top">skipBlocks</td>
    <td valign="top">
        Enables or disabled skipping of blocks like a pre-processor; defaults to `true`.
        See also option skipBlocksPattern.
    </td>
    <td valign="top">cpp</td>
    <td valign="top">No</td>
  </tr>
  <tr>
    <td valign="top">skipBlocksPattern</td>
    <td valign="top">
        Configures the pattern, to find the blocks to skip. It is a string property and contains of two parts,
        separated by `|`. The first part is the start pattern, the second part is the ending pattern.
        The default value is `#if 0|#endif`.
    </td>
    <td valign="top">cpp</td>
    <td valign="top">no</td>
  </tr>
  <tr>
    <td valign="top">language</td>
    <td valign="top">
        Flag to select the appropriate language (e.g. `c`, `cpp`, `cs`, `java`, `jsp`, `php`, `ruby`, `fortran`
        `ecmascript`, and `plsql`); defaults to `java`.
    </td>
    <td valign="top"></td>
    <td valign="top" align="center">No</td>
  </tr>
  <tr>
    <td valign="top">minimumtokencount</td>
    <td valign="top">A positive integer indicating the minimum duplicate size.</td>
    <td valign="top"></td>
    <td valign="top" align="center">Yes</td>
  </tr>
  <tr>
    <td valign="top">outputfile</td>
    <td valign="top">The destination file for the report. If not specified the console will be used instead.</td>
    <td valign="top"></td>
    <td valign="top" align="center">No</td>
  </tr>
</table>

<p>Also, you can get verbose output from this task by running ant with the <code class="highlighter-rouge">-v</code> flag; i.e.:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>ant -v -f mybuildfile.xml cpd
</code></pre>
</div>

<p>Also, you can get an HTML report from CPD by using the XSLT script in pmd/etc/xslt/cpdhtml.xslt.  Just run
the CPD task as usual and right after it invoke the Ant XSLT script like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;xslt in="cpd.xml" style="etc/xslt/cpdhtml.xslt" out="cpd.html" /&gt;
</code></pre>
</div>

<h2 id="gui">GUI</h2>

<p>CPD also comes with a simple GUI. You can start it via some scripts in the <code class="highlighter-rouge">bin</code> folder:</p>

<p>For Windows:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>cpdgui.bat
</code></pre>
</div>

<p>For Linux:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>./run.sh cpdgui
</code></pre>
</div>

<p>Here’s a screenshot of CPD after running on the JDK 8 java.lang package:</p>

<figure><img class="docimage" src="images/userdocs/screenshot_cpd.png" alt="CPD Screenshot after running on the JDK 8 java.lang package" /></figure>

<h2 id="suppression">Suppression</h2>

<p>Arbitrary blocks of code can be ignored through comments on <strong>Java</strong> by including the keywords <code class="highlighter-rouge">CPD-OFF</code> and <code class="highlighter-rouge">CPD-ON</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>public Object someParameterizedFactoryMethod(int x) throws Exception {
    // some unignored code

    // tell cpd to start ignoring code - CPD-OFF

    // mission critical code, manually loop unroll
    goDoSomethingAwesome(x + x / 2);
    goDoSomethingAwesome(x + x / 2);
    goDoSomethingAwesome(x + x / 2);
    goDoSomethingAwesome(x + x / 2);
    goDoSomethingAwesome(x + x / 2);
    goDoSomethingAwesome(x + x / 2);

    // resume CPD analysis - CPD-ON

    // further code will *not* be ignored
}
</code></pre>
</div>

<p>Additionally, <strong>Java</strong> allows to toggle suppression by adding the annotations
<strong><code class="highlighter-rouge">@SuppressWarnings("CPD-START")</code></strong> and <strong><code class="highlighter-rouge">@SuppressWarnings("CPD-END")</code></strong>
all code within will be ignored by CPD.</p>

<p>This approach however, is limited to the locations were <code class="highlighter-rouge">@SuppressWarnings</code> is accepted.
It’s legacy and the new comment’s based approch should be favored.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>//enable suppression
@SuppressWarnings("CPD-START")
public Object someParameterizedFactoryMethod(int x) throws Exception {
    // any code here will be ignored for the duplication detection
}
//disable suppression
@SuppressWarnings("CPD-END)
public void nextMethod() {
}
</code></pre>
</div>

<p>Other languages currently have no support to suppress CPD reports. In the future,
the comment based approach will be extended to those of them that can support it.</p>


    <div class="tags">
        
    </div>



</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2017 PMD Open Source Project. All rights reserved. <br />
 Site last generated: Dec 15, 2017 <br />
<p><img src="images/pmd-logo-small.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>

</body>

</html>
